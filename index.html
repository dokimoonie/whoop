<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whoop 模拟器 </title>
    <style>
        :root { --whoop-red: #ff3b30; --bg: #0a0a0a; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 400px; background: #1c1c1e; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { font-size: 22px; text-align: center; margin-bottom: 5px; }
        .sub { font-size: 12px; color: #888; text-align: center; margin-bottom: 30px; }
        
        .input-box { background: #2c2c2e; padding: 15px; border-radius: 12px; margin-bottom: 20px; }
        label { font-size: 12px; color: #8e8e93; display: block; margin-bottom: 5px; }
        input { width: 100%; background: transparent; border: none; color: white; font-size: 24px; font-weight: bold; outline: none; }
        
        .btn-pay { width: 100%; background: white; color: black; border: none; padding: 18px; border-radius: 14px; font-size: 17px; font-weight: 600; cursor: pointer; }
        
        /* 支付弹窗 */
        #apple-pay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center; }
        .sheet { background: #fff; color: #000; width: 85%; border-radius: 15px; padding: 20px; position: relative; }
        .faceid-anim { width: 50px; height: 50px; border: 3px solid #007aff; margin: 20px auto; border-radius: 12px; display: flex; align-items: center; justify-content: center; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

        /* 结果展示 */
        #results { display: none; }
        .res-item { padding: 12px; border-bottom: 1px solid #2c2c2e; font-size: 14px; }
        .hit { color: #34c759; font-weight: bold; background: rgba(52, 199, 89, 0.1); border-radius: 8px; }
        .miss { color: #8e8e93; }
        .summary { margin-top: 20px; padding: 15px; background: #000; border-radius: 12px; border: 1px solid var(--whoop-red); }
    </style>
</head>
<body>

<div class="container" id="main-ui">
    <h1>Whoop 抽选模拟</h1>
    <p class="sub">成员随机 | 项目随机 | 无法指定</p>
    
    <div class="input-box">
        <label>购买张数 (¥3,300/张)</label>
        <input type="number" id="count" value="10">
    </div>
    
    <button class="btn-pay" onclick="openPay()">确认支付</button>
    
    <div id="stats" style="margin-top:25px; font-size:12px; color:#555; text-align:center;"></div>
</div>

<div id="results" class="container">
    <h2 style="text-align:center">抽选结果</h2>
    <div id="list-box"></div>
    <div class="summary" id="sum-box"></div>
    <button class="btn-pay" style="margin-top:20px" onclick="location.reload()">不服，再来！</button>
</div>

<div id="apple-pay">
    <div class="sheet">
        <div style="text-align:center; font-weight:600;"> Pay</div>
        <p style="text-align:center; color:#888; font-size:13px; margin:10px 0;">付款给 Whoop Japan</p>
        <p style="text-align:center; font-size:28px; font-weight:bold;" id="pay-total"></p>
        <div class="faceid-anim" onclick="doDraw()">确认</div>
        <p style="text-align:center; font-size:12px; color:#007aff;" onclick="closePay()">取消</p>
    </div>
</div>

<script>
    const members = ["JACOB", "YOUNGHOON", "HYUNJAE", "JUYEON", "KEVIN", "NEW", "Q", "SUNWOO", "ERIC"];
    
    // --- 在这里调整概率 (0.01 = 1%) ---
    const prizePool = [
        { name: "双人合影", prob: 0.005 }, // 0.5% (极难)
        { name: "个人签名", prob: 0.015 }, // 1.5%
        { name: "个人手渡", prob: 0.040 }, // 4%
        { name: "拍手/Hi-Touch", prob: 0.080 } // 8%
    ];
    // ---------------------------------

    let totalSpent = 0;
    let totalWon = 0;

    function openPay() {
        const qty = document.getElementById('count').value;
        document.getElementById('pay-total').innerText = `¥${(qty * 3300).toLocaleString()}`;
        document.getElementById('apple-pay').style.display = 'flex';
    }

    function closePay() { document.getElementById('apple-pay').style.display = 'none'; }

    function doDraw() {
        closePay();
        const qty = parseInt(document.getElementById('count').value);
        totalSpent += qty * 3300;
        
        document.getElementById('main-ui').style.display = 'none';
        document.getElementById('results').style.display = 'block';
        
        const listBox = document.getElementById('list-box');
        listBox.innerHTML = "";
        let winCount = 0;

        for (let i = 1; i <= qty; i++) {
            let rand = Math.random();
            let won = null;
            let current = 0;

            for (let p of prizePool) {
                if (rand < p.prob) {
                    won = p;
                    break;
                }
            }

            const div = document.createElement('div');
            div.className = 'res-item';
            if (won) {
                winCount++;
                totalWon++;
                const m = members[Math.floor(Math.random() * members.length)];
                div.innerHTML = `<span class="hit">★ [${m}] ${won.name} 中选！</span>`;
            } else {
                div.innerHTML = `<span class="miss">第 ${i} 张：落选 (落选)</span>`;
            }
            
            if (qty <= 15 || won) listBox.appendChild(div);
        }

        if (qty > 15) {
            const more = document.createElement('div');
            more.className = 'res-item miss';
            more.style.textAlign = 'center';
            more.innerText = `... 其余未中选结果已折叠 ...`;
            listBox.appendChild(more);
        }

        document.getElementById('sum-box').innerHTML = `
            <div style="font-size:14px; color:#ff4757;">本次购买：${qty}张，中选：${winCount}</div>
            <div style="font-size:12px; color:#888; margin-top:8px;">
                累计花费：¥${totalSpent.toLocaleString()}<br>
                累计中选：${totalWon} (包含所有项目)
            </div>
        `;
    }
</script>

</body>
</html>
